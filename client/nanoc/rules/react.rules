#!/usr/bin/env ruby
# frozen_string_literal: true

{
  "Task" => ["tasks/new", "tasks/edit"],
  "Tasks" => ["/", "tasks"],
  "Projects" => ["projects"]
}.each do |component, paths|
  compile "/html/react.html.erb", rep: component do
    filter(:erb, locals: {name: "react-#{component.downcase}", src: "/js/main.js"})
    paths.each do |path|
      (path == "/") ? write("/index.html") : write("/#{path}/index.html")
    end
  end
end

compile "/js/main/main.tsx" do
  filter(:webpack, depend_on: %w[/js/components/ /js/hooks/ /js/types/])
  write("/js/main.js")
end
